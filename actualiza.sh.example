#!/bin/bash

# Script de deployment para Jekyll -> GitHub Pages
# Este script construye el sitio Jekyll y lo copia al repositorio de GitHub Pages
#
# INSTRUCCIONES:
# 1. Copia este archivo como 'actualiza.sh' (sin .example)
# 2. Modifica las variables JEKYLL_SOURCE_DIR y GITHUB_PAGES_DIR con tus rutas
# 3. Dale permisos de ejecuciÃ³n: chmod +x actualiza.sh
# 4. Ejecuta: ./actualiza.sh

# ========== CONFIGURACIÃ“N ==========
# Directorio donde estÃ¡ el cÃ³digo fuente de Jekyll (este proyecto)
JEKYLL_SOURCE_DIR="/path/to/your/jekyll/project"

# Directorio del repositorio GitHub Pages (username.github.io)
GITHUB_PAGES_DIR="/path/to/your/username.github.io"
# ===================================

echo "================================================"
echo "  Script de Deployment Jekyll -> GitHub Pages"
echo "================================================"
echo ""

# Verificar que las rutas estÃ¡n configuradas
if [ "$JEKYLL_SOURCE_DIR" = "/path/to/your/jekyll/project" ] || [ "$GITHUB_PAGES_DIR" = "/path/to/your/username.github.io" ]; then
    echo "âŒ ERROR: Por favor configura las rutas en este script antes de ejecutarlo."
    echo ""
    echo "Edita las variables:"
    echo "  - JEKYLL_SOURCE_DIR: Ruta a tu proyecto Jekyll"
    echo "  - GITHUB_PAGES_DIR: Ruta a tu repositorio username.github.io"
    exit 1
fi

# Verificar que existen los directorios
if [ ! -d "$JEKYLL_SOURCE_DIR" ]; then
    echo "âŒ ERROR: No existe el directorio de Jekyll: $JEKYLL_SOURCE_DIR"
    exit 1
fi

if [ ! -d "$GITHUB_PAGES_DIR" ]; then
    echo "âŒ ERROR: No existe el directorio de GitHub Pages: $GITHUB_PAGES_DIR"
    exit 1
fi

echo "ðŸ“¦ Paso 1: Construyendo sitio Jekyll..."
cd "$JEKYLL_SOURCE_DIR"
jekyll build

if [ $? -ne 0 ]; then
    echo "âŒ ERROR: FallÃ³ la construcciÃ³n de Jekyll"
    exit 1
fi

echo ""
echo "ðŸ§¹ Paso 2: Limpiando directorio de GitHub Pages..."
cd "$GITHUB_PAGES_DIR"
rm -rf *

echo ""
echo "ðŸ“‹ Paso 3: Copiando archivos generados..."
cd "$JEKYLL_SOURCE_DIR/_site"
cp -rf * "$GITHUB_PAGES_DIR"

echo ""
echo "ðŸ—‘ï¸  Paso 4: Eliminando archivos que no deben subirse..."
cd "$GITHUB_PAGES_DIR"
rm -f actualiza.sh 2>/dev/null
rm -f new_post.sh 2>/dev/null

echo ""
echo "ðŸ“Š Paso 5: Mostrando estado de Git..."
git status

echo ""
echo "âœ… Â¡Proceso completado!"
echo ""
echo "PrÃ³ximos pasos manuales:"
echo "  1. cd $GITHUB_PAGES_DIR"
echo "  2. git add ."
echo "  3. git commit -m \"ActualizaciÃ³n del sitio\""
echo "  4. git push origin main"
echo ""
